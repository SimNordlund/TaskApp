define(["exports","react","mendix/filters/builders"],(function(e,t,n){"use strict";var o;!function(e){e.STRING="string",e.NUMBER="number",e.ENUMERATION="enum",e.DATE="date",e.ASSOCIATION="association"}(o||(o={}));const i="com.mendix.widgets.web.filterable.filterContext";function r(){const e=window[i];if(e)return{FilterContext:e};const n=t.createContext(void 0);return window[i]=n,{FilterContext:n}}const s=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);function l(e,t){if(function(e){return s(e,"arg1")&&s(e,"arg2")}(e)&&"attribute"===e.arg1.type&&e.arg1.attributeId===t.id&&(n=e.arg2,s(n,"type")&&s(n,"value")))return{type:e.name,value:e.arg2.value};var n}function a(e,t){var n;if(!e||!t)return[];return(null!==(n=c(t))&&void 0!==n?n:[]).flatMap((t=>{const n=l(t,e);return n?[n]:[]}))}function c(e){return!e||"function"!==e.type||"and"!==e.name&&"or"!==e.name?e?[e]:void 0:e.args.flatMap(c).filter((e=>void 0!==e))}function u(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e,t){return"".concat(e,",").concat(t)}function h(e){const[t,n]=e.split(",");return[parseInt(t,10),parseInt(n,10)]}class g{constructor(e,t){u(this,"_listeners",void 0),u(this,"_focusTarget",void 0),u(this,"_positionController",void 0),u(this,"_layout",void 0),u(this,"dispatch",(e=>{const t=this._positionController.dispatch(e,this._layout);void 0!==t&&t!==this._focusTarget&&("Keyboard"===e.type?this._setTargetAndFocus(t):this._setTarget(t))})),this._listeners=[],this._focusTarget=this._getInitPosition(),this._positionController=e,this._layout=t}get focusTarget(){return this._focusTarget}addListener(e){this._listeners.push(e)}removeListener(e){this._listeners.splice(this._listeners.indexOf(e),1)}updateGridLayout(e){this._layout=e,void 0===this._layout.get(h(this._focusTarget))&&this._setTarget(this._getInitPosition())}_setTarget(e){const t=this._focusTarget;this._focusTarget=e,this._emit({lastPos:t,targetPos:e,shouldFocus:!1})}_setTargetAndFocus(e){const t=this._focusTarget;this._focusTarget=e,this._emit({lastPos:t,targetPos:e,shouldFocus:!0})}_emit(e){for(const t of this._listeners)t(e)}_getInitPosition(){return d(0,0)}}class m{constructor(e,t,n){u(this,"rows",void 0),u(this,"columns",void 0),u(this,"pageSize",void 0),u(this,"_positions",void 0),this.columns=t,this.rows=e,this.pageSize=n,this._positions=new Set;for(let n=0;n<e;n+=1)for(let e=0;e<t;e+=1)this._positions.add(d(e,n))}get(e){let[t,n]=e;const o=d(t<0?this.columns+t:t,n<0?this.rows+n:n);if(this._positions.has(o))return o}}const f=new Set(["ArrowUp","ArrowRight","ArrowDown","ArrowLeft","PageUp","PageDown","End","Home"]);const p={ArrowUp:function(e){let[t,n]=e;return[t,Math.max(0,n-1)]},ArrowRight:function(e){let[t,n]=e;return[t+1,n]},ArrowDown:function(e){let[t,n]=e;return[t,n+1]},ArrowLeft:function(e){let[t,n]=e;return[Math.max(0,t-1),n]},PageUp:(e,t)=>function(e,t){let[n,o]=e;return[n,Math.max(0,o-t)]}(e,t.pageSize),PageDown:(e,t)=>function(e,t,n){let[o,i]=e;return[o,Math.min(n-1,i+t)]}(e,t.pageSize,t.rows),End:(e,t,n)=>{let{ctrlKey:o}=n;return o?[-1,-1]:function(e){let[t,n]=e;return[-1,n]}(e)},Home:(e,t,n)=>{let{ctrlKey:o}=n;return o?[0,0]:function(e){let[t,n]=e;return[0,n]}(e)}};class v{dispatch(e,t){return"Focus"===e.type?this._handleFocusEvent(e.reactEvent):"Mouse"===e.type?this._handleMouseEvent(e.reactEvent):this._handleKeyboardEvent(e.reactEvent,t)}_handleKeyboardEvent(e,t){if(n=e.code,!f.has(n))return;var n;if(!Object.hasOwn(p,e.code))throw new Error("Keyboard nav: can't find handler for ".concat(e.code," key"));e.preventDefault();const o=h(this._getTargetPosition(e));return t.get(p[e.code](o,t,e))}_handleMouseEvent(e){return this._getTargetPosition(e)}_handleFocusEvent(e){return this._getTargetPosition(e)}_getTargetPosition(e){var t;const n=null===(t=e.currentTarget.dataset)||void 0===t?void 0:t.position;if(void 0===n)throw new Error("Keyboard navigation: target position is missing");return n}}const w=e=>{e&&e.canExecute&&!e.isExecuting&&e.execute()};class y{constructor(e){u(this,"selectionValue",void 0),u(this,"type","Single"),this.selectionValue=e}updateProps(e){this.selectionValue=e}isSelected(e){var t;return(null===(t=this.selectionValue.selection)||void 0===t?void 0:t.id)===e.id}add(e){this.selectionValue.setSelection(e)}remove(e){this.selectionValue.setSelection(void 0)}}class b{constructor(e,t){u(this,"selectionValue",void 0),u(this,"selectableItems",void 0),u(this,"type","Multi"),u(this,"rangeStart",void 0),u(this,"rangeEnd",void 0),this.selectionValue=e,this.selectableItems=t,this.rangeStart=void 0}isSelected(e){return this.selectionValue.selection.some((t=>t.id===e.id))}updateProps(e,t){this.selectionValue=e,this.selectableItems=t}get selectionStatus(){return 0===this.selectionValue.selection.length?"none":this.selectionValue.selection.length===this.selectableItems.length?"all":"some"}add(e){this._add(e),this._setRangeStart(e),this._setRangeEnd(void 0)}remove(e){this.isSelected(e)&&this.selectionValue.setSelection(this.selectionValue.selection.filter((t=>t.id!==e.id))),this._resetRange()}reduceTo(e){this.selectionValue.setSelection([e]),this._setRangeStart(e),this._setRangeEnd(void 0)}_add(e){this.isSelected(e)||this.selectionValue.setSelection(this.selectionValue.selection.concat(e))}_setRangeStart(e){let t=-1;void 0!==e&&(t=this.selectableItems.indexOf(e)),this.rangeStart=t>-1?t:void 0}_setRangeEnd(e){if(void 0===e)return void(this.rangeEnd=void 0);const t=this.rangeEnd,n=this.selectableItems.indexOf(e);this.rangeEnd=n>-1?n:void 0,this._updateSelectionWithRange(this.rangeStart,t,n)}_updateSelectionWithRange(e,t,n){if(void 0===e)return;if(-1===n)return;if(t===n)return;if(void 0===t){const t=this._getRange(e,n);return void this.selectionValue.setSelection(t)}const o=this._getRange(e,t),i=this._getRange(e,n);let r=[];r=this._diff(r,o),r=this._union(r,i),this.selectionValue.setSelection(r)}_getRange(e,t){const n=this.selectableItems.length,[o,i]=[S(e,0,n),S(t,0,n)].sort(((e,t)=>e-t));return this.selectableItems.slice(o,i+1)}_resetRange(){this._setRangeStart(void 0),this._setRangeEnd(void 0)}_union(e,t){const n=[...e],o=new Set(e.map((e=>e.id)));for(const e of t)o.has(e.id)||(o.add(e.id),n.push(e));return n}_diff(e,t){const n=new Set(e),o=new Set(t.map((e=>e.id)));for(const e of n)o.has(e.id)&&n.delete(e);return Array.from(n)}selectAll(){this.selectionValue.setSelection(this.selectableItems),this._resetRange()}selectNone(){this.selectionValue.setSelection([]),this._resetRange()}selectUpTo(e){void 0===this.rangeStart?(this._add(e),this._setRangeStart(e)):this._setRangeEnd(e)}_findIndexInList(e,t,n){const o=this.selectableItems.length-1,i="forward"===t;if("edge"===n)return i?o:0;return S(i?e+n:e-n,0,o)}_findIndexInGrid(e,t,n){const{columnIndex:o}=I(n,this.selectableItems.length,e);return"pagedown"===t?this.selectableItems.length-(n-o):"home"===t?e-o:"end"===t?e+(n-(o+1)):o}selectUpToAdjacent(e,t,n,o,i){if(!1===t)return void this._resetRange();const r=this.selectableItems.findIndex((t=>t.id===e.id));let s=-1;s="backward"===n||"forward"===n?this._findIndexInList(r,n,o):this._findIndexInGrid(r,n,null!=i?i:0),s!==r&&(void 0===this.rangeStart&&this._setRangeStart(e),this._setRangeEnd(this.selectableItems.at(s)))}}const S=(e,t,n)=>Math.min(Math.max(e,t),n);function E(e,n,o){const i=t.useRef([]),r=t.useRef(!1);r.current||(r.current="loading"!==(null==n?void 0:n.status)),t.useEffect((()=>{var t;const n=i.current,s=null!==(t=null==e?void 0:e.selection)&&void 0!==t?t:[],l=Array.isArray(s)?s:[s];(function(e,t){if(e.length!==t.length)return!1;const n=new Set(t.map((e=>e.id)));return e.every((e=>n.has(e.id)))})(n,l)||(i.current=l,r.current&&w(o))}),[null==e?void 0:e.selection,o]);const s=t.useRef(void 0);var l,a;void 0!==e&&("Single"===e.type?s.current?s.current.updateProps(e):s.current=new y(e):s.current?s.current.updateProps(e,null!==(l=n.items)&&void 0!==l?l:[]):s.current=new b(e,null!==(a=n.items)&&void 0!==a?a:[]));return s.current}function I(e,t,n){if(n<0||n>=t)return{columnIndex:-1,rowIndex:-1};const o=n%e,i=function(e,t){return Math.floor(e/t)}(n,e);return{columnIndex:o,rowIndex:i}}const C=new Set(["KeyA","MetaLeft","MetaRight","ControlLeft","ControlRight"]),x=(e,t)=>{let n=!1;const[o,i]=function(e,t){let n=0,o=0;return[function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];const l=(new Date).getTime()-o,a=()=>{n=0,o=(new Date).getTime(),e(...r)};n||(l>=t?a():n=window.setTimeout(a,t-l))},()=>{clearTimeout(n),n=0}]}((()=>{n=!0,e()}),500);return[{eventName:"onKeyDown",filter:(e,t)=>"Multi"===e.selectionType&&function(e){return"KeyA"===e.code&&(e.metaKey||e.ctrlKey)}(t),handler:o},{eventName:"onKeyUp",filter:(e,t)=>"Multi"===e.selectionType&&C.has(t.code)&&n,handler:()=>{n=!1,i(),null==t||t()}}]},_=(e,t)=>[{eventName:"onKeyDown",filter:(e,t)=>"ArrowUp"===t.code&&"Multi"===e.selectionType,handler:(n,o)=>{let{item:i}=n;return e(i,o.shiftKey,"backward",t)}},{eventName:"onKeyDown",filter:(e,t)=>"ArrowDown"===t.code&&"Multi"===e.selectionType,handler:(n,o)=>{let{item:i}=n;return e(i,o.shiftKey,"forward",t)}},{eventName:"onKeyDown",filter:(e,t)=>"ArrowLeft"===t.code&&"Multi"===e.selectionType,handler:(t,n)=>{let{item:o}=t;return e(o,n.shiftKey,"backward",1)}},{eventName:"onKeyDown",filter:(e,t)=>"ArrowRight"===t.code&&"Multi"===e.selectionType,handler:(t,n)=>{let{item:o}=t;return e(o,n.shiftKey,"forward",1)}},{eventName:"onKeyDown",filter:(e,t)=>"PageUp"===t.code&&"Multi"===e.selectionType,handler:(n,o)=>{let{item:i}=n;return e(i,o.shiftKey,"pageup",0,t)}},{eventName:"onKeyDown",filter:(e,t)=>"PageDown"===t.code&&"Multi"===e.selectionType,handler:(n,o)=>{let{item:i}=n;return e(i,o.shiftKey,"pagedown",0,t)}},{eventName:"onKeyDown",filter:(e,t)=>"Home"===t.code&&"Multi"===e.selectionType,handler:(n,o)=>{let{item:i}=n;return e(i,o.shiftKey,"home",0,t)}},{eventName:"onKeyDown",filter:(e,t)=>"End"===t.code&&"Multi"===e.selectionType,handler:(n,o)=>{let{item:i}=n;return e(i,o.shiftKey,"end",0,t)}}],P="com.mendix.widgets.web.selectable.selectionContext";class M{constructor(e,t){var n=this;u(this,"selection",void 0),u(this,"selectionHelper",void 0),u(this,"onSelect",(function(){n.selectionHelper&&("Multi"===n.selectionHelper.type?n._onSelectItemMulti(...arguments):n._onSelectItemSingle(...arguments))})),u(this,"_onSelectItemMulti",((e,t,n)=>{var o;"Multi"===(null===(o=this.selectionHelper)||void 0===o?void 0:o.type)&&(t?this.selectionHelper.selectUpTo(e):this.selectionHelper.isSelected(e)?this.selectionHelper.remove(e):n?this.selectionHelper.add(e):this.selectionHelper.reduceTo(e))})),u(this,"_onSelectItemSingle",(e=>{var t;"Single"===(null===(t=this.selectionHelper)||void 0===t?void 0:t.type)&&(this.selectionHelper.isSelected(e)?this.selectionHelper.remove(e):this.selectionHelper.add(e))})),u(this,"onSelectAll",(e=>{this.selectionHelper&&("Single"!==this.selectionHelper.type?"selectAll"!==e&&"all"===this.selectionHelper.selectionStatus?this.selectionHelper.selectNone():this.selectionHelper.selectAll():console.warn("Datagrid: calling onSelectAll in single selection mode have no effect"))})),u(this,"onSelectAdjacent",(function(){var e;"Multi"===(null===(e=n.selectionHelper)||void 0===e?void 0:e.type)&&n.selectionHelper.selectUpToAdjacent(...arguments)})),u(this,"isSelected",(e=>!!this.selectionHelper&&this.selectionHelper.isSelected(e))),this.selection=e,this.selectionHelper=t}get selectionType(){if(void 0===this.selection)return"None";if("object"==typeof this.selection)return this.selection.type;if("None"===this.selection||"Single"===this.selection||"Multi"===this.selection)return this.selection;throw new Error("Unknown selection type: ".concat(this.selection))}}function T(){const e=window["com.mendix.widgets.web.sortable.sortContext"];if(e)return{SortContext:e};const n=t.createContext(void 0);return window["com.mendix.widgets.web.sortable.sortContext"]=n,{SortContext:n}}function N(e){let{direction:n}=e;const o="pagination-icon ".concat(n);switch(n){case"forward":return t.createElement("span",{"aria-hidden":!0},t.createElement("svg",{className:o,viewBox:"0 0 32 32",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},t.createElement("path",{d:"M17.81 6.63C17.48 6.37 17 6.61 17 7.02V24.98C17 25.4 17.48 25.63 17.81 25.37L28.5 16.39C28.76 16.19 28.76 15.8 28.5 15.6L17.81 6.63Z",fill:"currentColor"}),t.createElement("path",{d:"M4.81 6.63C4.48 6.37 4 6.61 4 7.02V24.98C4 25.4 4.48 25.63 4.81 25.37L15.5 16.39C15.76 16.19 15.76 15.8 15.5 15.6L4.81 6.63Z",fill:"currentColor"})));case"step-forward":return t.createElement("span",{"aria-hidden":!0},t.createElement("svg",{className:o,viewBox:"0 0 32 32",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},t.createElement("path",{d:"M8.81 6.63C8.48 6.37 8 6.61 8 7.02V24.98C8 25.4 8.48 25.63 8.81 25.37L20.5 16.39C20.76 16.19 20.76 15.8 20.5 15.6L8.81 6.63Z",fill:"currentColor"}),t.createElement("path",{d:"M24 6H22V26H24V6Z",fill:"currentColor"})));case"backward":return t.createElement("span",{"aria-hidden":!0},t.createElement("svg",{className:o,viewBox:"0 0 32 32",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},t.createElement("path",{d:"M14.19 6.63L3.51 15.61C3.25 15.81 3.25 16.2 3.51 16.4L14.2 25.38C14.53 25.64 15.01 25.4 15.01 24.99V7.02C15.01 6.6 14.53 6.37 14.2 6.63H14.19Z",fill:"currentColor"}),t.createElement("path",{d:"M27.19 6.63L16.5 15.61C16.24 15.81 16.24 16.2 16.5 16.4L27.19 25.38C27.52 25.64 28 25.4 28 24.99V7.02C28 6.6 27.52 6.37 27.19 6.63Z",fill:"currentColor"})));case"step-backward":return t.createElement("span",{"aria-hidden":!0},t.createElement("svg",{className:o,viewBox:"0 0 32 32",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},t.createElement("path",{d:"M23.19 6.63L11.51 15.61C11.25 15.81 11.25 16.2 11.51 16.4L23.2 25.38C23.53 25.64 24.01 25.4 24.01 24.99V7.02C24.01 6.6 23.53 6.37 23.2 6.63H23.19Z",fill:"currentColor"}),t.createElement("path",{d:"M10 6H8V26H10V6Z",fill:"currentColor"})));default:return t.createElement("div",null)}}function k(e){var n,o,i,r,s,l,a;const c=void 0!==e.numberOfItems?Math.ceil(e.numberOfItems/e.pageSize):void 0,u=void 0!==c?c-1:0,d=void 0!==c,h=e.page*e.pageSize+1,g=e.canNextPage||!e.numberOfItems?(e.page+1)*e.pageSize:e.numberOfItems,m=t=>{e.setPaginationIndex&&e.setPaginationIndex(t)};if(0===e.numberOfItems)return null;const f="".concat(h," to ").concat(g," ").concat(d?"of ".concat(null!==(n=e.numberOfItems)&&void 0!==n?n:(null!=c?c:1)*e.pageSize):"");return t.createElement("div",{"aria-label":null!==(o=e.labelPagination)&&void 0!==o?o:"Pagination",className:"pagination-bar"},t.createElement("button",{className:"btn pagination-button",disabled:0===e.page,...K((()=>{e.gotoPage(0),m(0)})),"aria-label":null!==(i=e.labelFirstPage)&&void 0!==i?i:"Go to first page"},t.createElement(N,{direction:"step-backward"})),t.createElement("button",{className:"btn pagination-button",disabled:!e.canPreviousPage,...K((()=>{e.previousPage(),m(e.page-1)})),"aria-label":null!==(r=e.labelPreviousPage)&&void 0!==r?r:"Go to previous page"},t.createElement(N,{direction:"backward"})),t.createElement("span",{className:"sr-only sr-only-focusable"},null!==(s=e.labelPagingStatus)&&void 0!==s?s:"Currently showing"," ",f),t.createElement("div",{"aria-hidden":!0,className:"paging-status"},f),t.createElement("button",{"aria-label":null!==(l=e.labelNextPage)&&void 0!==l?l:"Go to next page",className:"btn pagination-button",disabled:!e.canNextPage,...K((()=>{e.nextPage(),m(e.page+1)}))},t.createElement(N,{direction:"forward"})),d&&t.createElement("button",{"aria-label":null!==(a=e.labelLastPage)&&void 0!==a?a:"Go to last page",className:"btn pagination-button",disabled:e.page===u,...K((()=>{e.gotoPage(u),m(u)}))},t.createElement(N,{direction:"step-forward"})))}function K(e){return{onClick:e,onKeyDown:t=>{" "!==t.key&&"Enter"!==t.key||(t.preventDefault(),t.stopPropagation(),e())}}}const A=Symbol("DefaultKeyNavContextValue"),D=t.createContext(A);function R(e){let{focusController:n,children:o}=e;const i=t.useMemo((()=>({focusController:n})),[n]);return t.createElement(D.Provider,{value:i},o)}var V,H={exports:{}};
/*!
  	Copyright (c) 2018 Jed Watson.
  	Licensed under the MIT License (MIT), see
  	http://jedwatson.github.io/classnames
  */V=H,function(){var e={}.hasOwnProperty;function t(){for(var n=[],o=0;o<arguments.length;o++){var i=arguments[o];if(i){var r=typeof i;if("string"===r||"number"===r)n.push(i);else if(Array.isArray(i)){if(i.length){var s=t.apply(null,i);s&&n.push(s)}}else if("object"===r){if(i.toString!==Object.prototype.toString&&!i.toString.toString().includes("[native code]")){n.push(i.toString());continue}for(var l in i)e.call(i,l)&&i[l]&&n.push(l)}}}return n.join(" ")}V.exports?(t.default=t,V.exports=t):window.classNames=t}();var L=H.exports;function F(e){let{children:n,className:o,selectionType:i,lg:r,md:s,sm:l,...a}=e;const c="None"!==i;return t.createElement("div",{...a,className:L("widget-gallery-items","widget-gallery-lg-".concat(r),"widget-gallery-md-".concat(s),"widget-gallery-sm-".concat(l),o),role:c?"listbox":"list","aria-multiselectable":c?"Multi"===i:void 0},n)}function O(e){const n=t.useRef(null),o=t.useRef(e.focusTarget),{focusController:i}=function(){const e=t.useContext(D);if(e===A)throw new Error("useKeyNavContext: context provider is missing");return e}(),[r,s]=t.useMemo((()=>{const t=d(e.columnIndex,e.rowIndex);return[t===i.focusTarget,t]}),[e.columnIndex,e.rowIndex,i.focusTarget]),[l,a]=t.useState({canFocus:!1});return t.useEffect((()=>{const e=e=>a((t=>e.lastPos===s?{canFocus:!1}:e.targetPos===s?{canFocus:e.shouldFocus}:t));return i.addListener(e),()=>i.removeListener(e)}),[i,s]),t.useEffect((()=>{const{current:e}=o;if(l.canFocus){const t="function"==typeof e?e():n.current;null==t||t.focus()}}),[l]),{ref:n,tabIndex:r?0:-1,"data-position":s}}function U(e){const{eventsController:n,getPosition:o,helper:i,item:r,itemIndex:s,selectHelper:l,...a}=e,c=i.hasOnClick(r)||"None"!==l.selectionType,u=function(e,t){return"Single"===t.selectionType||"Multi"===t.selectionType?{role:"option","aria-selected":t.isSelected(e),tabIndex:0}:{role:"listitem","aria-selected":void 0,tabIndex:void 0}}(r,l),{columnIndex:d,rowIndex:h}=o(s),g=O({columnIndex:null!=d?d:-1,rowIndex:h}),m=t.useMemo((()=>n.getProps(r)),[n,r]);return t.createElement("div",{...a,className:L("widget-gallery-item",{"widget-gallery-clickable":c,"widget-gallery-selected":u["aria-selected"]},i.itemClass(r)),...u,onClick:m.onClick,onFocus:m.onFocus,onKeyDown:m.onKeyDown,onKeyUp:m.onKeyUp,onMouseDown:m.onMouseDown,"data-position":g["data-position"],ref:g.ref,tabIndex:g.tabIndex},i.render(r))}function z(e){var n,o;const[i,r]=t.useState(!1),s=null!==(o=(n=t.useRef()).current)&&void 0!==o?o:n.current=function(e){let{setIsIntersecting:t}=e;return new IntersectionObserver((e=>{let[n]=e;t(n.isIntersecting)}))}({setIsIntersecting:r});return t.useEffect((()=>(e.current&&s.observe(e.current),()=>{s.disconnect()})),[s,e]),i}const j=30;function G(e){let{children:n,className:o,hasMoreItems:i,isInfinite:r,setPage:s}=e;const[l,a,c]=function(e){const{setPage:n,hasMoreItems:o,isInfinite:i}=e,[r,s]=t.useState(0),l=t.useRef(null),a=z(l),c=t.useCallback((e=>{Math.floor(e.target.scrollHeight-j-e.target.scrollTop)<=Math.floor(e.target.clientHeight)+2&&o&&n&&n((e=>e+1))}),[o,n]),u=t.useCallback((()=>{a&&i&&o&&r<=0&&l.current&&s(l.current.clientHeight-j)}),[i,o,r,a]);return t.useLayoutEffect((()=>{setTimeout((()=>u()),100)}),[u]),[c,r,l]}({hasMoreItems:i,isInfinite:r,setPage:s});return t.createElement("div",{className:L("widget-gallery-content",{"infinite-loading":r},o),ref:c,onScroll:r?l:void 0,style:r&&a>0?{maxHeight:a}:void 0},n)}function B(e){let{children:n,className:o,...i}=e;return t.createElement("div",{className:L("widget-gallery-footer",o),...i},n)}function Z(e){const{children:n}=e;return n?t.createElement("section",{...e,className:"widget-gallery-header widget-gallery-filter"}):null}function W(e){const{className:n,selectable:o,children:i,...r}=e;return t.createElement("div",{className:L("widget-gallery",{"widget-gallery-selectable":o},n),...r},i)}function q(e){return t.createElement("div",{className:"widget-gallery-top-bar"},e.children)}function Y(e){const n=e.paging?t.createElement("div",{className:"widget-gallery-pagination"},t.createElement(k,{canNextPage:e.hasMoreItems,canPreviousPage:0!==e.page,gotoPage:t=>e.setPage&&e.setPage((()=>t)),nextPage:()=>e.setPage&&e.setPage((e=>e+1)),numberOfItems:e.numberOfItems,page:e.page,pageSize:e.pageSize,previousPage:()=>e.setPage&&e.setPage((e=>e-1))})):null,o=e.paging&&"above"===e.paginationPosition,i=e.paging&&"below"===e.paginationPosition;return t.createElement(W,{className:e.className,selectable:!1,"data-focusindex":e.tabIndex||0},o&&t.createElement(q,null,n),e.showHeader&&t.createElement(Z,{"aria-label":e.headerTitle},e.header),t.createElement(G,{hasMoreItems:e.hasMoreItems,setPage:e.setPage,isInfinite:!e.paging},e.items.length>0&&t.createElement(F,{lg:e.desktopItems,md:e.tabletItems,sm:e.phoneItems,selectionType:e.selectHelper.selectionType,"aria-label":e.ariaLabelListBox},t.createElement(R,{focusController:e.focusController},e.items.map(((n,o)=>t.createElement(U,{key:"item_".concat(n.id),helper:e.itemHelper,item:n,selectHelper:e.selectHelper,eventsController:e.itemEventsController,getPosition:e.getPosition,itemIndex:o})))))),(0===e.items.length||e.showEmptyStatePreview)&&e.emptyPlaceholderRenderer&&e.emptyPlaceholderRenderer((n=>t.createElement("section",{className:"widget-gallery-empty","aria-label":e.emptyMessageTitle},t.createElement("div",{className:"empty-placeholder"},n)))),i&&t.createElement(B,null,n))}function J(e,t,n){const o=e();(!n.filter||n.filter(o,t))&&n.handler(o,t)}const Q=e=>({eventName:"onClick",handler:(t,n)=>e({type:"Mouse",reactEvent:n})}),X=e=>({eventName:"onKeyDown",handler:(t,n)=>e({type:"Keyboard",reactEvent:n})}),$=e=>({eventName:"onFocus",handler:(t,n)=>e({type:"Focus",reactEvent:n})});function ee(e){return[Q(e),X(e),$(e)]}function te(){var e;null===(e=window.getSelection())||void 0===e||e.removeAllRanges()}const ne=()=>{ne.timeoutId&&clearTimeout(ne.timeoutId),ne.timeoutId=window.setTimeout((()=>{te(),document.body.style.userSelect="",ne.timeoutId=void 0}),250)},oe=e=>({eventName:"onClick",filter:e=>"None"!==e.selectionType,handler:(t,n)=>{let{item:o}=t;const i=n.metaKey||n.ctrlKey;e(o,n.shiftKey,i)}}),ie=e=>({eventName:"onKeyUp",filter:(e,t)=>"None"!==e.selectionType&&function(e){return"Space"===e.code&&e.shiftKey}(t),handler:t=>{let{item:n}=t;return e(n,!1,!0)}});function re(e,t,n,o){return[(i=te,{eventName:"onMouseDown",filter:e=>"None"!==e.selectionType,handler:i}),oe(e),ie(e),x((()=>{document.body.style.userSelect="none",t("selectAll")}),(()=>{ne()})),_(n,o)].flat();var i}const se=e=>({eventName:"onClick",filter:()=>!0,handler:t=>{let{item:n}=t;return e(n)}}),le=(e,t)=>"Space"===t.code?!t.shiftKey:"Enter"===t.code,ae=e=>{let t=!1;return[{eventName:"onKeyDown",filter:le,handler:()=>t=!0},{eventName:"onKeyUp",filter:(e,n)=>le(0,n)&&t,handler:n=>{let{item:o}=n;t=!1,e(o)}}]};class ce{constructor(e,t,n,o,i,r,s){this.contextFactory=e,this.selectFx=t,this.selectAllFx=n,this.executeActionFx=o,this.focusTargetFx=i,this.selectAdjacentFx=r,this.numberOfColumns=s,this.getProps=e=>{var t,n;return function(e,t){const n=function(e){return e.reduce(((e,t)=>{var n,o,i,r,s,l;switch(t.eventName){case"onClick":e.onClick=null!==(n=e.onClick)&&void 0!==n?n:[],e.onClick.push(t);break;case"onDoubleClick":e.onDoubleClick=null!==(o=e.onDoubleClick)&&void 0!==o?o:[],e.onDoubleClick.push(t);break;case"onKeyDown":e.onKeyDown=null!==(i=e.onKeyDown)&&void 0!==i?i:[],e.onKeyDown.push(t);break;case"onKeyUp":e.onKeyUp=null!==(r=e.onKeyUp)&&void 0!==r?r:[],e.onKeyUp.push(t);break;case"onMouseDown":e.onMouseDown=null!==(s=e.onMouseDown)&&void 0!==s?s:[],e.onMouseDown.push(t);break;case"onFocus":e.onFocus=null!==(l=e.onFocus)&&void 0!==l?l:[],e.onFocus.push(t)}return e}),{})}(t);return{onClick(t){var o;null===(o=n.onClick)||void 0===o||o.forEach((n=>J(e,t,n)))},onDoubleClick(t){var o;null===(o=n.onDoubleClick)||void 0===o||o.forEach((n=>J(e,t,n)))},onKeyUp(t){var o;null===(o=n.onKeyUp)||void 0===o||o.forEach((n=>J(e,t,n)))},onKeyDown(t){var o;null===(o=n.onKeyDown)||void 0===o||o.forEach((n=>J(e,t,n)))},onMouseDown(t){var o;null===(o=n.onMouseDown)||void 0===o||o.forEach((n=>J(e,t,n)))},onFocus(t){var o;null===(o=n.onFocus)||void 0===o||o.forEach((n=>J(e,t,n)))}}}((()=>this.contextFactory(e)),[...re(this.selectFx,this.selectAllFx,this.selectAdjacentFx,this.numberOfColumns),...ee(this.focusTargetFx),...(t=this.executeActionFx,[se(t),(n=e=>{e.preventDefault(),e.stopPropagation()},{eventName:"onKeyDown",filter:(e,t)=>function(e){return"Space"===e.code&&e.target===e.currentTarget}(t),handler:(e,t)=>n(t)}),...ae(t)])])}}}function ue(e){const n=function(e){return e<768?"phone":e>=768&&e<992?"tablet":"desktop"}(function(){const[e,n]=t.useState(window.innerWidth);return t.useEffect((()=>{const e=e=>n(e.target.innerWidth);return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]),e}()),o=function(e,t){return e["".concat(t,"Items")]}(e,n),i=Math.ceil(e.totalItems/o);return{numberOfColumns:Math.min(o,e.totalItems),numberOfRows:i}}class de{constructor(e){this.listAction=e,this.onExecuteAction=e=>{this.listAction&&"get"in this.listAction&&w(this.listAction.get(e))}}update(e){this.listAction=e}}function he(e){return t.createElement("div",{...e,...ge,className:L("widget-gallery-item-button",e.className),role:"button",tabIndex:0})}const ge=function(){let e=!1;return{onKeyDown:t=>{me(t)&&(pe(t),fe(t)&&(e=!0))},onKeyUp:t=>{me(t)&&fe(t)&&e&&(pe(t),t.currentTarget.dispatchEvent(new MouseEvent("click",{bubbles:!0})),e=!1)}}}();function me(e){return"Enter"===e.code||"Space"===e.code}function fe(e){return e.currentTarget===e.target}function pe(e){e.stopPropagation(),e.preventDefault()}class ve{constructor(e,t,n){this._classValue=e,this._contentValue=t,this._clickValue=n}itemClass(e){var t;return null===(t=this._classValue)||void 0===t?void 0:t.get(e).value}render(e){var n,o;return this.hasOnClick(e)?t.createElement(he,{onClick:()=>{var t;return w(null===(t=this._clickValue)||void 0===t?void 0:t.get(e))}},null===(n=this._contentValue)||void 0===n?void 0:n.get(e)):null===(o=this._contentValue)||void 0===o?void 0:o.get(e)}hasOnClick(e){var t;return!!(null===(t=this._clickValue)||void 0===t?void 0:t.get(e))}}class we extends M{constructor(){var e;super(...arguments),e=this,this.onSelectAdjacentGrid=function(){var t;"Multi"===(null===(t=e.selectionHelper)||void 0===t?void 0:t.type)&&e.selectionHelper.selectUpToAdjacent(...arguments)}}}e.Gallery=function(e){var i,s,l,c,u;const d=t.useRef(void 0),h=t.useRef(void 0),[f,p]=t.useState(!1),[w,y]=t.useState(!1),b={[o.STRING]:t.useState(),[o.NUMBER]:t.useState(),[o.DATE]:t.useState(),[o.ENUMERATION]:t.useState(),[o.ASSOCIATION]:t.useState()},[S,C]=t.useState(),{FilterContext:x}=r(),{SortContext:_}=T(),M=(void 0===window[P]&&(window[P]=t.createContext(void 0)),window[P]),N="virtualScrolling"===e.pagination,k=N?e.datasource.limit/e.pageSize:e.datasource.offset/e.pageSize;t.useEffect((()=>{e.datasource.requestTotalCount(!N),e.datasource.limit===Number.POSITIVE_INFINITY&&e.datasource.setLimit(e.pageSize)}),[e.datasource,e.pageSize,N]),t.useEffect((()=>{!e.datasource.filter||f||d.current||(d.current=e.datasource.filter),!e.datasource.sortOrder||w||h.current||(h.current=e.datasource.sortOrder)}),[e.datasource,f,w]);const K=t.useMemo((()=>e.filterList.reduce(((e,t)=>{let{filter:n}=t;return{...e,[n.id]:n}}),{})),[e.filterList]),A=t.useMemo((()=>e.sortList.map((e=>{let{attribute:t,caption:n}=e;var o;return{attribute:t,caption:null!==(o=n.value)&&void 0!==o?o:""}}))),[e.sortList]),D=t.useMemo((()=>e.filterList.reduce(((e,t)=>{let{filter:n}=t;return{...e,[n.id]:a(n,d.current)}}),{})),[e.filterList,d.current]),R=Object.keys(b).map((e=>{var t;return null===(t=b[e][0])||void 0===t?void 0:t.getFilterCondition()})).filter((e=>void 0!==e));if(R.length>0?e.datasource.setFilter(R.length>1?n.and(...R):R[0]):f?e.datasource.setFilter(void 0):e.datasource.setFilter(d.current),S&&"getSortCondition"in S){const t=S.getSortCondition();e.datasource.setSortOrder(t?[t]:void 0)}else e.datasource.setSortOrder(void 0);const V=t.useCallback((t=>{const n=t(k);N?e.datasource.setLimit(n*e.pageSize):e.datasource.setOffset(n*e.pageSize)}),[e.datasource,e.pageSize,N,k]),H=E(e.itemSelection,e.datasource,e.onSelectionChange),L=function(e,n){return t.useMemo((()=>new we(e,n)),[n])}(e.itemSelection,H),F=null!==(i=e.datasource.items)&&void 0!==i?i:[],O={desktopItems:e.desktopItems,phoneItems:e.phoneItems,tabletItems:e.tabletItems,totalItems:F.length},{numberOfColumns:U,numberOfRows:z}=ue(O),j=t.useCallback((e=>I(U,F.length,e)),[U,F.length]),G=function(e){let{rows:n,columns:o,pageSize:i}=e;const r=t.useRef(null);return t.useMemo((()=>{const e=new m(n,o,i);return null===r.current?r.current=new g(new v,e):r.current.updateGridLayout(e),r.current}),[n,o,i])}({rows:z,columns:U,pageSize:e.pageSize}),B=function(e){const n=t.useMemo((()=>new de(e.onClick)),[]);return t.useEffect((()=>{n.update(e.onClick)})),n}({onClick:e.onClick}),Z=function(e,n,o,i){return t.useMemo((()=>new ce((t=>({item:t,selectionType:e.selectionType})),e.onSelect,e.onSelectAll,n.onExecuteAction,o.dispatch,e.onSelectAdjacentGrid,i)),[e,o,i])}(L,B,G,U),W=function(e){const n=t.useCallback((()=>{"Multi"===(null==e?void 0:e.type)&&("all"===e.selectionStatus?e.selectNone():e.selectAll())}),[e]),o="Multi"===(null==e?void 0:e.type)?e.selectionStatus:void 0;return t.useMemo((()=>{if(void 0!==o)return{status:o,toggle:n}}),[o,n])}(H),q=e.filterList.length>0||e.sortList.length>0||"Multi"===(null==H?void 0:H.type),J=(Q={classValue:e.itemClass,contentValue:e.content,clickValue:e.onClick},t.useMemo((()=>new ve(Q.classValue,Q.contentValue,Q.clickValue)),[Q.classValue,Q.contentValue,Q.clickValue]));var Q;return t.createElement(Y,{className:e.class,desktopItems:e.desktopItems,emptyPlaceholderRenderer:t.useCallback((n=>"custom"===e.showEmptyPlaceholder?n(e.emptyPlaceholder):t.createElement("div",null)),[e.emptyPlaceholder,e.showEmptyPlaceholder]),emptyMessageTitle:null===(s=e.emptyMessageTitle)||void 0===s?void 0:s.value,header:t.useMemo((()=>q?t.createElement(x.Provider,{value:{filterDispatcher:e=>{if(e.filterType){const[,t]=b[e.filterType];t(e),p(!0)}return e},multipleAttributes:K,multipleInitialFilters:D}},t.createElement(_.Provider,{value:{sortDispatcher:e=>(y(!0),C(e),e),attributes:A,initialSort:h.current}},t.createElement(M.Provider,{value:W},e.filtersPlaceholder))):null),[x,_,b,K,D,q,e.filtersPlaceholder,A]),headerTitle:null===(l=e.filterSectionTitle)||void 0===l?void 0:l.value,ariaLabelListBox:null===(c=e.ariaLabelListBox)||void 0===c?void 0:c.value,showHeader:q,hasMoreItems:null!==(u=e.datasource.hasMoreItems)&&void 0!==u&&u,items:F,itemHelper:J,numberOfItems:e.datasource.totalCount,page:k,pageSize:e.pageSize,paging:"buttons"===e.pagination,paginationPosition:e.pagingPosition,phoneItems:e.phoneItems,setPage:V,tabletItems:e.tabletItems,tabIndex:e.tabIndex,selectHelper:L,itemEventsController:Z,focusController:G,getPosition:j})},Object.defineProperty(e,"__esModule",{value:!0})}));
